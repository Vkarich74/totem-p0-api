<template id="totem_gate_repair_salons_schedule" name="TOTEM Gate Repair Page">
  <t t-call="website.layout">
    <div id="wrap" class="container" style="padding:24px 0;">
      <h3>TOTEM Cabinet Gate</h3>
      <p><b>URL:</b> /salons/schedule</p>
      <div style="border:1px solid #ddd; padding:12px; border-radius:8px; margin:12px 0;">
        <div><b>Status:</b> LOADING / role-check...</div>
        <pre id="totem_resolve_dump" style="white-space:pre-wrap; margin:8px 0 0 0;">waitingâ€¦</pre>
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <a class="btn btn-primary" href="/salons/cabinet">/salons/cabinet</a>
        <a class="btn btn-primary" href="/masters/cabinet">/masters/cabinet</a>
        <a class="btn btn-secondary" href="/s/totem-demo-salon">/s/totem-demo-salon</a>
      </div>

      <p style="margin-top:16px; color:#666;">
        This page is a temporary diagnostic shell. It must show /auth/resolve output below.
      </p>
    </div>

    <!-- Ensure role gate JS is present even if global inject is broken -->
    <script type="text/javascript" src="/web/content/430"/>

    <!-- Inline visible resolve probe (safe) -->
    <script type="text/javascript">
      (function(){
        function put(x) {
          var el = document.getElementById("totem_resolve_dump");
          if (!el) return;
          try { el.textContent = JSON.stringify(x, null, 2); }
          catch(e) { el.textContent = String(x); }
        }
        fetch("/auth/resolve", {credentials:"include"})
          .then(function(r){ return r.json(); })
          .then(function(j){ put(j); })
          .catch(function(e){ put({error:String(e)}); });
      })();
    </script>
  </t>
</template>